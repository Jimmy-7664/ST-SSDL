dataset: METRLA
num_nodes: 207
seq_len: 12
horizon: 12
input_dim: 1
output_dim: 1
embed_dim: 20
cheb_k: 3
rnn_layers: 1
rnn_units: 128
mem_num: 20
mem_dim: 64
loss: mask_mae_loss
epochs: 200
patience: 30
batch_size: 64
lr: 0.01
steps: [50, 100]
lr_decay_ratio: 0.1
weight_decay: 0
epsilon: 0.001
max_grad_norm: 5
use_curriculum_learning: True
adj_type: symadj
cl_decay_steps: 2000
gpu: 2
seed: 345
temp: 1.0
lamb_c: 0.1
lamb_d: 1
lamb_xq: 0
lamb_xp: 0
margin_newD: 5
contra_loss: triplet
compact_loss: mse
detect_loss: mae
use_mask: False
use_STE: True
adaptive_embedding_dim: 0
node_embedding_dim: 20
input_embedding_dim: 1
 
METRLA training and testing started Thu May 22 07:06:13 2025
train xs.shape, ys.shape (23974, 12, 207, 3) (23974, 12, 207, 3)
val xs.shape, ys.shape (3425, 12, 207, 3) (3425, 12, 207, 3)
test xs.shape, ys.shape (6850, 12, 207, 3) (6850, 12, 207, 3)
Trainable parameter list: 
In total: 625539 trainable parameters. 
Epoch [1/200] (375) train_loss: 5.8433, train_mae_loss: 2.5239, train_contra_loss: 0.2764, train_detect_loss: 3.2918, val_loss: 3.2536, lr: 0.010000, 335.81s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   6647  110523   14295  120400   35993   12396   26169   24423   17923
    20042   10397   17467  408848   10977 3480475   27070  541193   32230
    25099   20051]
 [ 104075  793709  127881  480793  318629   99102  205204  147314  144504
   174923   96747  116899  671016  113482  222853  136557  176053  190494
   145556  496827]
 [   6828   72483   13796  124053   38654   13185   25784   27432   18027
    19863   10102   18048  400298   11433 3679938   31041  371345   27520
    29949   22839]
 [  90499  691334  112345  523014  328069  119108  200100  162256  143360
   177593   90626  117104  702333  131898  234156  151839  165349  183637
   154785  483213]] 
Horizon overall: mae: 3.5919, mape: 9.9027, rmse: 7.3288 
Horizon 15mins: mae: 3.0265, mape: 7.8357, rmse: 5.9653 
Horizon 30mins: mae: 3.5751, mape: 9.7830, rmse: 7.2734 
Horizon 60mins: mae: 4.4566, mape: 13.0659, rmse: 9.0177 

 
Epoch [2/200] (750) train_loss: 6.0665, train_mae_loss: 2.2854, train_contra_loss: 0.0920, train_detect_loss: 3.7719, val_loss: 3.1030, lr: 0.010000, 335.71s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   3954    1071     981    2039    1267    1549    3056     674    3407
      388     600     332    4803     203 3643128    1471 1273517    1368
    17804    1006]
 [ 167028  262856   35874  196843   74091   43985   84209   43652  274890
    49425   70436   58504  219031   44590  508471  295759  839775   96597
  1504100   92502]
 [   5349    1217    1066    2681    1434    2269    5165     743    4301
      290     710     457    7055     238 3778599    1750 1122457    2344
    23184    1309]
 [ 167242  231824   32132  167498   86010   53602   89342   41329  216396
    53675   69535   56902  233998   47342  550126  290570  827150   85958
  1573187   88800]] 
Horizon overall: mae: 3.4148, mape: 9.7196, rmse: 7.0194 
Horizon 15mins: mae: 2.9264, mape: 7.8057, rmse: 5.7625 
Horizon 30mins: mae: 3.4158, mape: 9.6734, rmse: 6.9755 
Horizon 60mins: mae: 4.1459, mape: 12.5801, rmse: 8.5717 

 
Epoch [3/200] (1125) train_loss: 6.0244, train_mae_loss: 2.2054, train_contra_loss: 0.1330, train_detect_loss: 3.8057, val_loss: 3.0033, lr: 0.010000, 334.91s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   2681     557     267     401     364     145      46     244     906
      252      88      53    2321      92 3384897     206 1562890     371
     5574     263]
 [ 170212  137611   17335  181385  196879   52737   15536   16013  165564
    17093   43402  113293  180181   18127 1061075   34227 1741317   41022
   670315   89294]
 [   3607     690     252     475     786     252     113     220     129
       37      65      75    3617      52 3485183     266 1459103     546
     6809     341]
 [ 181993  111041   11834  192085  205299   56202   18570   13435   72449
    21066   32693  102602  185152   14420 1092056   27689 1844893   39887
   650745   88507]] 
Horizon overall: mae: 3.2966, mape: 9.4869, rmse: 6.5707 
Horizon 15mins: mae: 2.8571, mape: 7.7657, rmse: 5.4228 
Horizon 30mins: mae: 3.3216, mape: 9.5875, rmse: 6.5837 
Horizon 60mins: mae: 3.9277, mape: 11.9510, rmse: 7.9276 

 
Epoch [4/200] (1500) train_loss: 6.4939, train_mae_loss: 2.1242, train_contra_loss: 0.1367, train_detect_loss: 4.3561, val_loss: 2.9538, lr: 0.010000, 331.14s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   7645    1422     437     422     536      39     206     539    9227
      365     454     259    1488     140 3277339     396 1654216    1679
     5654     155]
 [ 260008  330808   32528  298130   81348   57689   46416   58044  395093
     9993   47530   69983   84065   15919 1048317   34887 1881143   63390
    91955   55372]
 [   6442    1280     306     438     580      53     193     510    6438
      218     505     309    1047      96 3340344     461 1596019    1765
     5472     142]
 [ 263577  313082   28290  343340   92170   63974   49682   51000  357242
    10636   45029   70221   85148   14232 1002151   42149 1915175   72684
    82385   60451]] 
Horizon overall: mae: 3.2522, mape: 9.0352, rmse: 6.8337 
Horizon 15mins: mae: 2.7756, mape: 7.3410, rmse: 5.4397 
Horizon 30mins: mae: 3.2559, mape: 9.0866, rmse: 6.7664 
Horizon 60mins: mae: 3.9729, mape: 11.5299, rmse: 8.5151 

 
Epoch [5/200] (1875) train_loss: 6.9788, train_mae_loss: 2.0802, train_contra_loss: 0.1246, train_detect_loss: 4.8862, val_loss: 2.8432, lr: 0.010000, 325.73s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   8725     505      43    1485     162      44     103      56   37656
       70    1920     117     114     114 2901280      73 2006104     141
     3881      25]
 [ 439903   86705   28272  596901   43669   20919    9737   85631  824496
    34084   71288   54827   15931   24861 1026083   12565 1485511    6426
    63029   31780]
 [   7855     276      46    1324     190      48      86      22   32471
       34    2377     117     179      95 2960066      65 1953052     215
     4086      14]
 [ 448720   89634   24768  649285   52279   22175   12238   76169  791585
    29807   83442   56493   17887   24717  976806   17254 1473937    9207
    69518   36697]] 
Horizon overall: mae: 3.1178, mape: 8.5422, rmse: 6.4352 
Horizon 15mins: mae: 2.7164, mape: 7.1589, rmse: 5.2629 
Horizon 30mins: mae: 3.1475, mape: 8.6733, rmse: 6.4450 
Horizon 60mins: mae: 3.6992, mape: 10.5163, rmse: 7.8089 

 
Epoch [6/200] (2250) train_loss: 7.2857, train_mae_loss: 2.0542, train_contra_loss: 0.1221, train_detect_loss: 5.2193, val_loss: 2.8665, lr: 0.010000, 326.78s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   1154     198      11     857     257      90     551      37   69809
       39       6       9      46     141 2603645       9 2285663      80
        6      10]
 [ 123932  238532   18342  456835  148174   58089   65670   45807 1008512
    28052   91747   71223   32845   35559 1087812   13837 1379617   17589
    18532   21912]
 [   1196     287       9     712     291      63     563      35   65427
       28      20       8      24     157 2669417       6 2224257     110
        2       6]
 [ 127831  240262   15453  510640  161037   60034   68848   38496  988144
    30447   98512   89897   36692   39106 1015195   21109 1351931   27046
    17183   24755]] 
Horizon overall: mae: 3.1623, mape: 9.0144, rmse: 6.6422 
Horizon 15mins: mae: 2.7254, mape: 7.1392, rmse: 5.3247 
Horizon 30mins: mae: 3.1809, mape: 9.0446, rmse: 6.6250 
Horizon 60mins: mae: 3.8082, mape: 11.7255, rmse: 8.1749 

 
Epoch [7/200] (2625) train_loss: 7.5236, train_mae_loss: 2.0325, train_contra_loss: 0.1124, train_detect_loss: 5.4799, val_loss: 2.8325, lr: 0.010000, 329.05s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   5141    1665       3     721      52      96       1      56   74710
        5       7      26      11     119 2429882      31 2450061      10
       16       5]
 [ 189222  803051   50881   85023  119500   20084    5496   57572 1146896
    12533   44244   36579   36713   49216 1025450   12212 1181824   47750
    23412   14960]
 [   6039    3525       4     738      51      61       8      62   73100
       13       7       7      10     260 2490220      33 2388469       5
        6       0]
 [ 210603  826650   47999   76030  142514   19118    5062   55487 1181480
    13384   38630   41301   32679   56185  956101   14134 1149126   68822
    10034   17279]] 
Horizon overall: mae: 3.0942, mape: 8.0977, rmse: 6.4098 
Horizon 15mins: mae: 2.6959, mape: 6.7286, rmse: 5.2306 
Horizon 30mins: mae: 3.1241, mape: 8.1583, rmse: 6.4270 
Horizon 60mins: mae: 3.6716, mape: 10.0729, rmse: 7.7746 

 
Epoch [8/200] (3000) train_loss: 7.7600, train_mae_loss: 2.0198, train_contra_loss: 0.1035, train_detect_loss: 5.7298, val_loss: 2.8648, lr: 0.010000, 328.24s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  21715    2878       2      54       7    1862       3      26   48401
       64       1       5      34      39 2341086       8 2546396       5
        6      26]
 [ 458471  924404  101778    7836   24255   27316   13466   16906 1175635
    23137   46291   31144   30165   13936  932123   22454 1038205   33737
    14145   27214]
 [  23096    4036       0      35       4    2461       2      32   48436
       38       0       5      48      65 2396273       8 2488049       3
        2      25]
 [ 485096  890874   98782    7561   30130   21285   12604   16181 1267499
    23968   45876   34352   31085   15551  866678   27326 1006260   41759
    10361   29390]] 
Horizon overall: mae: 3.1243, mape: 8.2490, rmse: 6.4995 
Horizon 15mins: mae: 2.6915, mape: 6.7630, rmse: 5.2365 
Horizon 30mins: mae: 3.1345, mape: 8.2856, rmse: 6.4619 
Horizon 60mins: mae: 3.7730, mape: 10.4048, rmse: 8.0005 

 
Epoch [9/200] (3375) train_loss: 7.9475, train_mae_loss: 2.0083, train_contra_loss: 0.0997, train_detect_loss: 5.9292, val_loss: 2.7887, lr: 0.010000, 325.73s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  50334    1450       0      74       5    3476       7      36   33450
      119       0      14      10      68 2284375      98 2589068      18
        3      13]
 [1061617  261291  240924   18584   40223  129302   50890   35913  890374
    24790   44679   26727   36826   16539  875834   44877 1021118   69538
    34594   37978]
 [  56209    2174       6      38       4    4886       8      57   35130
       48       1       8      11      55 2352009     148 2511777      33
        0      16]
 [1136968  228474  240546   14237   40603  116820   50369   31858  962153
    19957   41077   28282   31646   18858  807529   50782  984273   90279
    29792   38115]] 
Horizon overall: mae: 3.0612, mape: 8.0884, rmse: 6.4182 
Horizon 15mins: mae: 2.6628, mape: 6.7906, rmse: 5.2257 
Horizon 30mins: mae: 3.0818, mape: 8.2073, rmse: 6.4111 
Horizon 60mins: mae: 3.6491, mape: 9.9213, rmse: 7.8325 

 
Epoch [10/200] (3750) train_loss: 8.0641, train_mae_loss: 1.9976, train_contra_loss: 0.0968, train_detect_loss: 6.0568, val_loss: 2.7933, lr: 0.010000, 320.49s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  56797     745       1      91      10    4600       1      35   29072
       61       1      19      81      48 2248677     280 2621926     149
       10      14]
 [ 918003   94071  235963   24798   32852  696026   58253   53845  678039
     7648   14429   31805   20997   15236  857222   19043 1022420   72288
    75362   34318]
 [  64189     734       7      88       9    5987       3      39   31096
        8       1       8     140      49 2325195     593 2534272     164
       17      19]
 [ 998154   66760  238374   20079   36353  679153   62257   49335  743565
     4252   10302   30098   21917   14802  781032   23816  988973   81660
    75654   36082]] 
Horizon overall: mae: 3.0329, mape: 8.0389, rmse: 6.3025 
Horizon 15mins: mae: 2.6437, mape: 6.7284, rmse: 5.1452 
Horizon 30mins: mae: 3.0556, mape: 8.1617, rmse: 6.3044 
Horizon 60mins: mae: 3.6059, mape: 9.8528, rmse: 7.6697 

 
Epoch [11/200] (4125) train_loss: 8.1840, train_mae_loss: 1.9893, train_contra_loss: 0.0953, train_detect_loss: 6.1851, val_loss: 2.8060, lr: 0.010000, 318.95s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  60198     382       7     100      31    4546      15      39   41192
      133      55      59     100      38 2236574     107 2618689     303
       16      34]
 [ 579781    9984  195117   12156   48118 1285625   27139   45326  623794
    13089   32841   31859   20665   18512  777900    8118  982621  111866
    97550   40557]
 [  69010      69      14      76      67    5222      34       1   46884
        6      83      81      80      11 2321215      84 2519211     459
        2       9]
 [ 677088    4884  199760   11829   53486 1210437   28805   43780  694496
    10710   29153   33009   21506   15880  699727    9330  953878  115628
   106162   43070]] 
Horizon overall: mae: 3.0584, mape: 8.3343, rmse: 6.4055 
Horizon 15mins: mae: 2.6617, mape: 6.7532, rmse: 5.2075 
Horizon 30mins: mae: 3.0817, mape: 8.3579, rmse: 6.4027 
Horizon 60mins: mae: 3.6402, mape: 10.6357, rmse: 7.8120 

 
Epoch [12/200] (4500) train_loss: 8.2834, train_mae_loss: 1.9835, train_contra_loss: 0.0975, train_detect_loss: 6.2901, val_loss: 2.7859, lr: 0.010000, 319.46s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  74945     552      15      95      18    4991       1      58   39871
       28      32       6      31      37 2311882      41 2529937      64
        3      11]
 [ 711850   14065  180265   14114   15675 1186610   19636   65640  640171
     6515  188409   12445   11050   35596  741890    6826  995550   14114
    69779   32418]
 [  94008      41      31      32       6    5693       1      30   47173
        3     268       1      24      12 2390902      39 2424326      14
        1      13]
 [ 861151    7709  180280   12697   15378 1093926   19282   63602  708754
     4481  198333   11989   11644   30773  652677    8638  964092   12936
    72232   32044]] 
Horizon overall: mae: 3.0215, mape: 8.1859, rmse: 6.3185 
Horizon 15mins: mae: 2.6352, mape: 6.7340, rmse: 5.1493 
Horizon 30mins: mae: 3.0425, mape: 8.2574, rmse: 6.3040 
Horizon 60mins: mae: 3.5919, mape: 10.2548, rmse: 7.7142 

 
Epoch [13/200] (4875) train_loss: 8.3995, train_mae_loss: 1.9761, train_contra_loss: 0.0956, train_detect_loss: 6.4138, val_loss: 2.8426, lr: 0.010000, 316.25s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  45946    1600       9      49       4    6418       5      40   77461
       45      54      10      31      18 2276700      69 2554034     103
       18       4]
 [ 489085   20538  178301   20181   15769 1232167   38591   59530  807585
    18874  169162   14269   13570   56871  683171    7190  971204   20698
    87617   58245]
 [  53267     319      25      10       3    5905       0      20   95411
       17     255       1       2       5 2365829      24 2441488      28
        6       3]
 [ 601888    9761  177635   20805   15747 1116352   40788   59554  887761
    16381  179548   14697   13830   53638  607707    8497  956046   21268
    97948   62767]] 
Horizon overall: mae: 3.1271, mape: 8.7193, rmse: 6.5923 
Horizon 15mins: mae: 2.6807, mape: 6.9277, rmse: 5.2529 
Horizon 30mins: mae: 3.1332, mape: 8.6956, rmse: 6.5274 
Horizon 60mins: mae: 3.8081, mape: 11.4042, rmse: 8.2166 

 
Epoch [14/200] (5250) train_loss: 8.4429, train_mae_loss: 1.9716, train_contra_loss: 0.0966, train_detect_loss: 6.4616, val_loss: 2.8141, lr: 0.010000, 318.82s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  50050    2658       8      88      19    2355       6      38   84972
      116      14      30      68      31 2329664      64 2492274     122
       24      17]
 [ 688761   37546  127224   36238   19065  810510   49939   77516  891765
    34073  163179   16819   16195   63371  675187   16030  981047   37703
   107109  113341]
 [  59200     329      10      24      24    1446       4       5  105182
       85      15       6      23       5 2419879      28 2376215      34
       20      84]
 [ 815473   11048  129144   37996   19251  699693   49141   78425  960074
    30250  161910   19567   15312   57932  594247   16161  971348   41531
   128032  126083]] 
Horizon overall: mae: 3.0788, mape: 8.7845, rmse: 6.5134 
Horizon 15mins: mae: 2.6579, mape: 6.9500, rmse: 5.2233 
Horizon 30mins: mae: 3.0998, mape: 8.7928, rmse: 6.4949 
Horizon 60mins: mae: 3.7040, mape: 11.4756, rmse: 8.0348 

 
Epoch [15/200] (5625) train_loss: 8.4951, train_mae_loss: 1.9643, train_contra_loss: 0.0970, train_detect_loss: 6.5211, val_loss: 2.7745, lr: 0.010000, 318.59s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  66862    4312       5     108      10    1871       2      21   84303
      173      16      17      66      41 2315126      61 2489489     120
        3      12]
 [ 714912   68640  143629   57285   11252  823406   54982  108609  845141
    45623  127422   17251   17768   79113  639765   29980  976655   17172
    88627   95386]
 [  82968    1042       1      22       2    1333       0       5  103168
       22       3       6      23       5 2387675      10 2386270      41
       21       1]
 [ 854287   18674  148515   59332    9682  731955   53537  103529  913935
    44714  116990   19581   18626   70376  574137   28625  962508   15645
   109738  108232]] 
Horizon overall: mae: 3.0356, mape: 8.7660, rmse: 6.3515 
Horizon 15mins: mae: 2.6334, mape: 6.7841, rmse: 5.1092 
Horizon 30mins: mae: 3.0470, mape: 8.6527, rmse: 6.2844 
Horizon 60mins: mae: 3.6437, mape: 11.7673, rmse: 7.8693 

 
Epoch [16/200] (6000) train_loss: 8.5271, train_mae_loss: 1.9593, train_contra_loss: 0.0939, train_detect_loss: 6.5583, val_loss: 2.8071, lr: 0.010000, 319.71s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  70529    6389       3     163      19     362       1      43   86977
      251      16      10      98     149 2308099      41 2489327      86
       50       5]
 [ 817721  290378  117813   70010    7494  465384   36935  109145 1047921
    51859  109624   28443   19587  133715  609210   28891  881916   12641
    67519   56412]
 [  89912    4976       6      48       6     324       0      13  109741
       68       1       3      48      34 2398119      11 2359098      51
      158       1]
 [ 955681  196351  125577   71080    6907  411886   35567  105454 1114471
    51760  100698   32011   24524  129146  542309   26432  870796   12364
    84679   64925]] 
Horizon overall: mae: 3.0707, mape: 8.7207, rmse: 6.3599 
Horizon 15mins: mae: 2.6569, mape: 6.8786, rmse: 5.1868 
Horizon 30mins: mae: 3.0895, mape: 8.6808, rmse: 6.3540 
Horizon 60mins: mae: 3.6867, mape: 11.4713, rmse: 7.7644 

 
Epoch [17/200] (6375) train_loss: 8.5847, train_mae_loss: 1.9549, train_contra_loss: 0.0966, train_detect_loss: 6.6201, val_loss: 2.8494, lr: 0.010000, 320.28s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  84511   22074      42     165      37     172       4      59   92693
      543      49      70     131     407 2312466     144 2448863     131
       45      12]
 [ 816141  794414   67272   19976    5371   78467   33804  112436  966224
    35401   47697   31629   24765  386442  573481   24590  867530    9347
    41342   26289]
 [  96162   19395      46     112      50     145       1      13  109805
      131      43      30     122     127 2399048      90 2336974     152
      167       5]
 [ 936504  674748   71171   19196    5563   61643   31616  108731 1023258
    28784   38328   37148   33133  405751  521636   23213  854477   10859
    49683   27176]] 
Horizon overall: mae: 3.1188, mape: 9.3017, rmse: 6.5478 
Horizon 15mins: mae: 2.6487, mape: 6.9961, rmse: 5.1479 
Horizon 30mins: mae: 3.1262, mape: 9.2275, rmse: 6.4731 
Horizon 60mins: mae: 3.8065, mape: 12.6206, rmse: 8.1820 

 
Epoch [18/200] (6750) train_loss: 8.6569, train_mae_loss: 1.9508, train_contra_loss: 0.0953, train_detect_loss: 6.6966, val_loss: 2.8259, lr: 0.010000, 323.46s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  75640    5515     126     392     206     209       0     363  107941
      328     211      99     167     556 2274415     142 2496180      28
       55      45]
 [ 884809  382431   19687    9894   25718  100686   41391  183932 1405069
     7807   50018   13460   37531  244877  582509   26837  865685    7284
    27900   45093]
 [  87309    3405     144     339     202     224       8     298  133905
      156     110      59     100     528 2360529      75 2374940      48
      226      13]
 [1007253  270115   17378    8149   26560   90209   38000  184506 1446860
     4308   44862   14491   48137  250812  532571   23162  860542   10470
    35832   48401]] 
Horizon overall: mae: 3.0783, mape: 8.5082, rmse: 6.3382 
Horizon 15mins: mae: 2.6566, mape: 6.8875, rmse: 5.1708 
Horizon 30mins: mae: 3.0959, mape: 8.5822, rmse: 6.3335 
Horizon 60mins: mae: 3.7066, mape: 10.8111, rmse: 7.7277 

 
Epoch [19/200] (7125) train_loss: 8.7242, train_mae_loss: 1.9456, train_contra_loss: 0.0941, train_detect_loss: 6.7693, val_loss: 2.7687, lr: 0.010000, 324.71s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[ 103616    4067     170     371    1004    1558      10    1315  100544
      647     170      94     134     493 2254442     134 2493629      50
      115      55]
 [ 796591  788262    8434   89395   19740  136022   18323  271924 1213117
    21355   64704    5686   17466  140400  520904   18805  799300    3922
    14764   13504]
 [ 116738    4768     172     209     749    1714      12    1162  119871
      447      99      34     184     526 2324055     143 2391479      41
      184      31]
 [ 920976  676543    8292   93177   15149  114785   17220  287501 1278803
    18214   58239    7116   25120  138936  466150   14982  784164    4975
    20254   12022]] 
Horizon overall: mae: 3.0279, mape: 8.6262, rmse: 6.3136 
Horizon 15mins: mae: 2.6444, mape: 6.9049, rmse: 5.1399 
Horizon 30mins: mae: 3.0584, mape: 8.6927, rmse: 6.3270 
Horizon 60mins: mae: 3.5812, mape: 11.0484, rmse: 7.6688 

 
Epoch [20/200] (7500) train_loss: 8.7686, train_mae_loss: 1.9410, train_contra_loss: 0.0883, train_detect_loss: 6.8187, val_loss: 2.8390, lr: 0.010000, 326.21s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  93908   10026     582     245     419    2986      17    1026   79892
     4770     271      90     161     529 2184504      88 2582815     165
       83      41]
 [ 641995  885712   15664   16689   10246  264762   10214  343345  927798
   453733   31210    8880   13135   29862  509983   16182  753291    5224
    14821    9872]
 [ 116146   11407     755     107     256    3469      33     889   89833
     2087     157      31     167     491 2274085      37 2462322     174
      142      30]
 [ 770869  838141   17687   11759    5107  200641    8720  379258  973413
   449911   25745   11130   17443   25684  442367   12893  737092    5594
    20630    8534]] 
Horizon overall: mae: 3.1086, mape: 8.9795, rmse: 6.5309 
Horizon 15mins: mae: 2.6753, mape: 6.9714, rmse: 5.2041 
Horizon 30mins: mae: 3.1321, mape: 8.9635, rmse: 6.4878 
Horizon 60mins: mae: 3.7401, mape: 11.8742, rmse: 8.0759 

 
Epoch [21/200] (7875) train_loss: 8.8279, train_mae_loss: 1.9376, train_contra_loss: 0.0886, train_detect_loss: 6.8815, val_loss: 2.7654, lr: 0.010000, 324.22s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  69005   15016     487     284     275    6443       5     356  102025
     9395     276      78      67     413 2164735      42 2593487     121
       81      27]
 [ 660775  572885   10527   14792   10093  388790    8329   34474  992316
   916350   18983    7505   12948   12711  493397   13896  756449    6307
    14231   16860]
 [  81073   16783     598     102     296    8281      18     320  113166
     3079      77     148      89     288 2233371      19 2504654      92
      144      20]
 [ 746821  579984   11782   10288    7967  312935    8673   41254 1066272
   901541   15928    9888   12729   11101  426756    9813  742766    6005
    22606   17509]] 
Horizon overall: mae: 3.0308, mape: 8.0038, rmse: 6.2943 
Horizon 15mins: mae: 2.6397, mape: 6.7474, rmse: 5.1274 
Horizon 30mins: mae: 3.0505, mape: 8.1314, rmse: 6.2813 
Horizon 60mins: mae: 3.6133, mape: 9.7747, rmse: 7.6857 

 
Epoch [22/200] (8250) train_loss: 8.8626, train_mae_loss: 1.9413, train_contra_loss: 0.0905, train_detect_loss: 6.9122, val_loss: 2.8659, lr: 0.010000, 321.15s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  78874   28800     525     343     210     958      45     238   81534
     8622     186     113      67     447 2125776      38 2635636      83
       96      27]
 [ 889414  826559   13460   15074   13232   87533   27537   82950  889963
   683853   16623   11467   10393   29285  506817   13069  807713    8452
    12815   16409]
 [  86307   34699     690     106     189     837      83     116   86786
     1816      44     108      75     266 2193857      21 2556465      69
       70      14]
 [ 971379  802135   10827    9772    9278   61044   31297   99111  931126
   668127   13806   14580   10480   29681  443604   10063  808064    4826
    16588   16830]] 
Horizon overall: mae: 3.1286, mape: 9.2147, rmse: 6.5762 
Horizon 15mins: mae: 2.6746, mape: 7.0367, rmse: 5.2196 
Horizon 30mins: mae: 3.1457, mape: 9.1494, rmse: 6.5200 
Horizon 60mins: mae: 3.8002, mape: 12.4098, rmse: 8.1873 

 
Epoch [23/200] (8625) train_loss: 8.8934, train_mae_loss: 1.9361, train_contra_loss: 0.0845, train_detect_loss: 6.9489, val_loss: 2.8858, lr: 0.010000, 318.24s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  36889   64220     590     195     906     764      25     157   67446
     4117     395     212      59    1045 2074519      38 2710739      58
      223      21]
 [ 591567 1370596   26774    6840   23160   19387   13944   76382  769951
   621341   41737   28138    9626   36672  504674   20872  760414   13740
    13007   13796]
 [  39716   61304     819      69     665     672      22      67   68241
     1505     180     300      85     676 2137004      12 2650918      49
      302      12]
 [ 649832 1289054   27191    4325   15601   17545   13400   88933  847299
   620347   35134   35972   13927   36846  459787   18598  743717   16089
    16025   12996]] 
Horizon overall: mae: 3.1410, mape: 9.0299, rmse: 6.6269 
Horizon 15mins: mae: 2.6843, mape: 6.9251, rmse: 5.2540 
Horizon 30mins: mae: 3.1575, mape: 8.9555, rmse: 6.5736 
Horizon 60mins: mae: 3.8093, mape: 12.1076, rmse: 8.2213 

 
Epoch [24/200] (9000) train_loss: 8.9246, train_mae_loss: 1.9379, train_contra_loss: 0.0792, train_detect_loss: 6.9788, val_loss: 2.7986, lr: 0.010000, 316.24s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  19451   23748     915     979    2019    1520      95     285   64841
     7167     877     227     144    1178 2035353     139 2799591      84
     3934      71]
 [ 559627  777094   62251   42224   48302  310727   12090   38816  748684
   621603   74582   62662   16783    6715  556850   41900  746962   19027
   202522   13197]
 [  19702   29719    1099     474     755    1339     107     184   69822
     2901     301     172     139     687 2094630      87 2735586      75
     4745      94]
 [ 568205  837304   48373   27903   27900  264770   13350   40440  844736
   626431   55218   72061   16203    3282  513965   41194  737759   23696
   189670   10158]] 
Horizon overall: mae: 3.0528, mape: 8.7950, rmse: 6.4210 
Horizon 15mins: mae: 2.6517, mape: 7.0453, rmse: 5.2163 
Horizon 30mins: mae: 3.0813, mape: 8.8509, rmse: 6.4399 
Horizon 60mins: mae: 3.6362, mape: 11.3307, rmse: 7.8104 

 
Epoch [25/200] (9375) train_loss: 8.9781, train_mae_loss: 1.9334, train_contra_loss: 0.0779, train_detect_loss: 7.0369, val_loss: 2.7971, lr: 0.010000, 316.57s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  11766   12745    1036    1333    2928    1272     227     186   37455
     9534    1594     248     195    1284 2050933     306 2809428     167
    19837     144]
 [ 488427  699513   30722   42168   54138  213130   15860   41061  542283
   395099  370562   54644   27156    7063  570289   84886  755595    5579
   555906    8537]
 [  12094   12418    1283     820    1423    1595     239      61   34993
     2866     591     253     199     602 2102471     278 2766183     210
    23990      49]
 [ 496903  713330   29751   25230   30002  203154   18303   44560  612854
   380075  364891   66949   22655    3487  539950   88518  746938    8092
   560609    6367]] 
Horizon overall: mae: 3.0716, mape: 8.7376, rmse: 6.4670 
Horizon 15mins: mae: 2.6605, mape: 6.8751, rmse: 5.2104 
Horizon 30mins: mae: 3.0959, mape: 8.7408, rmse: 6.4461 
Horizon 60mins: mae: 3.6801, mape: 11.4474, rmse: 7.9531 

 
Epoch [26/200] (9750) train_loss: 8.9570, train_mae_loss: 1.9385, train_contra_loss: 0.0821, train_detect_loss: 7.0103, val_loss: 2.8226, lr: 0.010000, 316.61s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   9974    6328     770    2446     654    1088     158     245   49854
     8821     615     100      65    1948 2027335      91 2772254     203
    79610      59]
 [ 896433  300586   62050   17367   11394   69665   23410  102285  658501
   399688  195209   62659    6746    9113  507526   20704  731498    3146
   881189    3449]
 [   9441    6858     833    1010     192    1437     185      94   48338
     2039     275      70      20    1072 2069854      56 2739692     248
    80880      24]
 [ 908475  312653   57588    7819    3562   78717   29777  112804  700571
   401222  189650   75712    5825    5325  490075   19855  718833    3926
   837870    2359]] 
Horizon overall: mae: 3.0921, mape: 7.9579, rmse: 6.4434 
Horizon 15mins: mae: 2.6611, mape: 6.6637, rmse: 5.1745 
Horizon 30mins: mae: 3.1041, mape: 8.0385, rmse: 6.3891 
Horizon 60mins: mae: 3.7363, mape: 9.8134, rmse: 7.9740 

 
Epoch [27/200] (10125) train_loss: 8.9559, train_mae_loss: 1.9433, train_contra_loss: 0.0851, train_detect_loss: 7.0041, val_loss: 2.7963, lr: 0.010000, 315.90s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   6951    4244     981    1195     360    1276     702     223   44273
     8097     904     113      91    5245 2023821     104 2747039     359
   116557      83]
 [ 916840  139067  253735    7265    5556   35178   96101   97200  540863
   430318  106237   68906    7608   15076  522647   31422  754205    6866
   924591    2937]
 [   6621    4867     811     433     113    1991    1145     103   49097
     2655     592      64      42    4793 2071784      50 2698251     314
   118858      34]
 [ 934501  152416  221897    3146    2811   40034  122919  103924  586340
   440456   79932   84735    7673   12633  507600   33290  743074    7820
   875442    1975]] 
Horizon overall: mae: 3.0481, mape: 7.9550, rmse: 6.2407 
Horizon 15mins: mae: 2.6524, mape: 6.7080, rmse: 5.1017 
Horizon 30mins: mae: 3.0667, mape: 8.0904, rmse: 6.2223 
Horizon 60mins: mae: 3.6504, mape: 9.7117, rmse: 7.6439 

 
Epoch [28/200] (10500) train_loss: 8.9381, train_mae_loss: 1.9424, train_contra_loss: 0.0863, train_detect_loss: 6.9870, val_loss: 2.8535, lr: 0.010000, 317.45s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  13058    2904     485    4335     433    4288     318      84   48796
     5789     196      27     130   20494 2024698       3 2729708      33
   106790      49]
 [ 912910   44270  178340   56081    6342  240802  136126   35072  544091
   457282   41676   87192    9158  138213  504862    4650  767520    1772
   791913    4346]
 [  11886    3118     291     915     105    5438     365      21   51855
     3411      46      11     141   20079 2076396       0 2678908      19
   109593      20]
 [ 903162   43600  148292   43667    2570  268250  171258   28764  565712
   473016   22671  105314   10444  140151  492903    5435  772046    1535
   761543    2285]] 
Horizon overall: mae: 3.1187, mape: 9.0826, rmse: 6.5586 
Horizon 15mins: mae: 2.6817, mape: 7.0332, rmse: 5.2304 
Horizon 30mins: mae: 3.1429, mape: 9.0838, rmse: 6.5430 
Horizon 60mins: mae: 3.7502, mape: 12.0137, rmse: 8.0700 

 
Epoch [29/200] (10875) train_loss: 8.9649, train_mae_loss: 1.9504, train_contra_loss: 0.0856, train_detect_loss: 7.0059, val_loss: 2.7917, lr: 0.010000, 317.73s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  23084    1659     869    6579     367    5109     189      75   28737
     3748     365      77     273   32291 2006637       7 2760174       9
    92212     157]
 [ 728375   10373  138985   72021    5522  666918  127137   49753  355930
   447193   17804   91432   14287  240719  530488    8447  768912     976
   675008   12338]
 [  23923    1494     326     917     179    5279     161       5   28307
     2364     104      40     413   36023 2066450       1 2703957      21
    92603      51]
 [ 752870    8969  101289   57820    2575  691623  165135   43350  327422
   466151    8202  113780   14175  255752  515335    9654  768133     714
   651606    8063]] 
Horizon overall: mae: 3.0458, mape: 8.4384, rmse: 6.4206 
Horizon 15mins: mae: 2.6529, mape: 6.8772, rmse: 5.2156 
Horizon 30mins: mae: 3.0751, mape: 8.4956, rmse: 6.4270 
Horizon 60mins: mae: 3.6133, mape: 10.6824, rmse: 7.8153 

 
Epoch [30/200] (11250) train_loss: 9.0084, train_mae_loss: 1.9493, train_contra_loss: 0.0848, train_detect_loss: 7.0506, val_loss: 2.8215, lr: 0.010000, 321.10s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  26002    1239     806    4287     295    3107      75     110   26651
     3107     497     148     400   25399 1970817       5 2791828      31
   107692     122]
 [ 609251    7004  185027   63269    4617  671848   50482  119905  432697
   382603    8417   47225   13384  216670  518294    6095  764463    2619
   849684    9064]
 [  25124    1280     273     717     159    3508      66       6   25042
     2733     160      42     351   26758 2018615       1 2748802      19
   108927      35]
 [ 632618   10030  129884   53118    2359  717748   63492  115465  403449
   407875    4221   59583   10583  222743  510521    7074  771689    2073
   832938    5155]] 
Horizon overall: mae: 3.0701, mape: 8.7808, rmse: 6.2228 
Horizon 15mins: mae: 2.6694, mape: 7.0002, rmse: 5.1311 
Horizon 30mins: mae: 3.1043, mape: 8.8535, rmse: 6.2389 
Horizon 60mins: mae: 3.6451, mape: 11.2788, rmse: 7.5104 

 
Epoch [31/200] (11625) train_loss: 9.0088, train_mae_loss: 1.9561, train_contra_loss: 0.0897, train_detect_loss: 7.0438, val_loss: 2.8172, lr: 0.010000, 320.89s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  49806    1313     730    8226     212    2334      83     217   14532
     2305     886     395    1252   25852 2011658       3 2761002      70
    81541     201]
 [ 765472    5398   94704   85078    3621  642129   25123  193867  283364
   344736   13632   27368   55784  265678  572142    6489  810789    2254
   755665    9325]
 [  53095    1417     387    1131      59    3258      88      38    9819
     2449     225     190     986   27705 2074387      11 2700395      99
    86786      93]
 [ 781995    6967   61160   69829    2367  666171   32788  182023  245779
   383067    8389   30260   40137  289541  547419    8439  819350    1823
   779493    5621]] 
Horizon overall: mae: 3.0894, mape: 9.1115, rmse: 6.4919 
Horizon 15mins: mae: 2.6672, mape: 7.1132, rmse: 5.2162 
Horizon 30mins: mae: 3.1085, mape: 9.0813, rmse: 6.4544 
Horizon 60mins: mae: 3.7158, mape: 12.0669, rmse: 8.0115 

 
Epoch [32/200] (12000) train_loss: 9.0371, train_mae_loss: 1.9733, train_contra_loss: 0.0885, train_detect_loss: 7.0550, val_loss: 2.7920, lr: 0.010000, 322.99s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  37942    1097     688   12912     403     844      49     144    6869
     3557    1005     256    1478   47008 1938898      14 2809899     126
    99302     127]
 [ 692481    6470   57597  106449    4705  618788   11127  184155  178174
   410887   17190   11769  108136  402781  574142   25165  764174    3021
   777351    8056]
 [  34417    1128     330    2708     272     832      92      45    2412
     3782     148     103    1081   45833 1980075      11 2785178     106
   104022      43]
 [ 690374    8376   43479   86140    3981  649426   13690  165803  146219
   451507    7827   11079   75896  422970  560102   30575  764890    2365
   823850    4069]] 
Horizon overall: mae: 3.0788, mape: 7.9323, rmse: 6.3747 
Horizon 15mins: mae: 2.6758, mape: 6.7179, rmse: 5.2169 
Horizon 30mins: mae: 3.1126, mape: 8.0727, rmse: 6.4036 
Horizon 60mins: mae: 3.6573, mape: 9.6211, rmse: 7.7094 

 
Epoch [33/200] (12375) train_loss: 9.0039, train_mae_loss: 1.9950, train_contra_loss: 0.0940, train_detect_loss: 6.9995, val_loss: 2.8536, lr: 0.010000, 319.91s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  28564     658     450   11528     666     267      90     298    4991
     4660    1124     201    1061   50093 1931761       8 2781036     103
   144971      88]
 [ 622425    6903   36247  116863    6499  481902   11844  345124  185035
   240670   13774   11345   54177  399943  576097   16193  793252    3418
  1034783    6124]
 [  23503     778     211    2256     398      73      90     100    1675
     3590     219     103     770   45980 1991128       1 2754225      84
   137422      12]
 [ 613623    8515   31034  109157    5567  487513   13044  342519  161287
   243867    6009   10993   39111  418396  572667   18421  810882    2443
  1064254    3316]] 
Horizon overall: mae: 3.1169, mape: 8.9315, rmse: 6.3790 
Horizon 15mins: mae: 2.6816, mape: 6.9624, rmse: 5.1330 
Horizon 30mins: mae: 3.1391, mape: 8.9078, rmse: 6.3562 
Horizon 60mins: mae: 3.7560, mape: 11.7976, rmse: 7.8462 

 
Epoch [34/200] (12750) train_loss: 9.0208, train_mae_loss: 1.9923, train_contra_loss: 0.0952, train_detect_loss: 7.0189, val_loss: 2.8554, lr: 0.010000, 322.81s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  32781     531     459   12261     687     183     220     244    2485
     8093    1035     243     849   62927 1914398       9 2797766     124
   127045     278]
 [ 647201    8776   43163  132035    6925  348380   14168  499443  108116
   186566   10499   12360   21866  580365  597397   37553  810984    6559
   871711   18551]
 [  25579     401     293    2889     841      74     237      74     935
     5730     222      28     724   58339 1963953       0 2775576      58
   126605      60]
 [ 665762    8889   39117  130484    4734  325641   14216  502051   87578
   138628    4672   10480   15884  617465  596285   37631  824285    3433
   921451   13932]] 
Horizon overall: mae: 3.1468, mape: 8.6094, rmse: 6.6770 
Horizon 15mins: mae: 2.7411, mape: 7.2162, rmse: 5.4614 
Horizon 30mins: mae: 3.1702, mape: 8.7623, rmse: 6.6843 
Horizon 60mins: mae: 3.7874, mape: 10.6870, rmse: 8.2016 

 
Epoch [35/200] (13125) train_loss: 8.9961, train_mae_loss: 2.0228, train_contra_loss: 0.1021, train_detect_loss: 6.9630, val_loss: 2.8686, lr: 0.010000, 326.10s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  15207     228     249   13369     702     581     251     188    1286
    17045    1571     319    1049  127321 1952471      27 2746579     311
    83371     493]
 [ 243045    3246   25893  157481    9561  386858   28951  497422   23779
   395916   14012    8920   21339  917338  609992    9949  884648    6546
   681476   36246]
 [  13683     156      97    1471     534     592     167      90     266
    13278     847      85     953  117510 2011904       0 2722092     238
    78523     132]
 [ 249893    3002   20670  159526    5997  384058   37064  500066   15509
   293072    6279    7890   21587  987810  590230   10475  902325    4161
   733655   29349]] 
Horizon overall: mae: 3.1392, mape: 9.3572, rmse: 6.5126 
Horizon 15mins: mae: 2.7107, mape: 7.2666, rmse: 5.2411 
Horizon 30mins: mae: 3.1664, mape: 9.3570, rmse: 6.4902 
Horizon 60mins: mae: 3.7645, mape: 12.3863, rmse: 8.0157 

 
Epoch [36/200] (13500) train_loss: 8.9792, train_mae_loss: 2.0341, train_contra_loss: 0.1019, train_detect_loss: 6.9349, val_loss: 2.8075, lr: 0.010000, 325.87s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[  12152     284     731   14947    7069     187     457     300     427
    31168    1340     425     950  174231 1944930      59 2754191     220
    17820     730]
 [ 192421    4585   82910  188077  122203  349311   35287  541210   11279
   547447   14718   11008   19261 1083495  649726   13691  830870    6609
   234125   24385]
 [  10205     337     536    3632    2139     138     289      97      84
    31275     340     200     576  148185 1997368       8 2754285     157
    12617     150]
 [ 205464    5215   66555  191096  105840  332134   39418  541098    6273
   531775    5362    8179   15002 1134935  644537   15839  851833    5585
   242773   13705]] 
Horizon overall: mae: 3.0515, mape: 8.7963, rmse: 6.3076 
Horizon 15mins: mae: 2.6516, mape: 6.8531, rmse: 5.1064 
Horizon 30mins: mae: 3.0689, mape: 8.7360, rmse: 6.2598 
Horizon 60mins: mae: 3.6522, mape: 11.7071, rmse: 7.7755 

 
Epoch [37/200] (13875) train_loss: 9.0366, train_mae_loss: 2.0569, train_contra_loss: 0.1035, train_detect_loss: 6.9694, val_loss: 2.8044, lr: 0.010000, 325.55s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   5897     801     441   17886    1128      22     266     535     153
    36655     480     200     909  196133 1928476      60 2765517     171
     6414     474]
 [ 173992   35890  103499  305640   21854   94536   19062  334058    3229
   710095    8471    8500   26520 1170296  646490    4185  814884    5527
   459776   16114]
 [   4111     742     240    3064     128       8     214     133      12
    35596      71      79     651  161602 1982639      10 2768851     111
     4297      59]
 [ 170475   39813   72733  325424   15694   81614   20134  302999    1476
   708822    2695    4731   23222 1216223  652422    3736  847096    4537
   462445    6327]] 
Horizon overall: mae: 3.0593, mape: 8.8464, rmse: 6.3919 
Horizon 15mins: mae: 2.6636, mape: 6.9776, rmse: 5.1829 
Horizon 30mins: mae: 3.0921, mape: 8.8878, rmse: 6.3989 
Horizon 60mins: mae: 3.6276, mape: 11.4843, rmse: 7.7906 

 
Epoch [38/200] (14250) train_loss: 9.0429, train_mae_loss: 2.0766, train_contra_loss: 0.0976, train_detect_loss: 6.9565, val_loss: 2.8302, lr: 0.010000, 325.55s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   3276    1078     131   21747     908      17     476     999     625
    31434     790     860     862  111698 1858949     190 2918548     316
     8876     838]
 [ 183223  102409   26569  388788   20066   91246   17735  324905    6551
   547201    9770   14416   78006  802447  757432    8636  910174   14549
   639027   19468]
 [   2392    1080      30    4274     178      27     242     193     246
    33637     171     459     716   99617 1919942      51 2892320     162
     6565     316]
 [ 182728   92567   14125  424752   15742   77017   17347  280113    2972
   583083    2946    8671   66221  863733  753378    7323  947579   14484
   599590    8247]] 
Horizon overall: mae: 3.0789, mape: 8.1357, rmse: 6.4778 
Horizon 15mins: mae: 2.6674, mape: 6.7672, rmse: 5.2293 
Horizon 30mins: mae: 3.0957, mape: 8.2134, rmse: 6.4436 
Horizon 60mins: mae: 3.6886, mape: 10.1092, rmse: 7.9619 

 
Epoch [39/200] (14625) train_loss: 9.0549, train_mae_loss: 2.1224, train_contra_loss: 0.0991, train_detect_loss: 6.9226, val_loss: 2.7565, lr: 0.010000, 326.12s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   4300      69     258   26196     339      33     470    1831     572
     6661     528     503     555   83673 1823124     243 2999585     209
    13323     146]
 [ 296560    1706   16650  469837    9308   22748   13838  199301    4648
   672317    4424   12216   78081  624170  830453   20033  928404    9016
   739844    9064]
 [   2900      86      76    4929      95      10     324     716     145
     7600     107     144     425   66670 1909160      57 2961250      82
     7795      47]
 [ 299383    1315   11351  505218    6088   10784   14273  156544    1942
   740557     901    6660   61138  607021  843357   15554  981914    8196
   685723    4699]] 
Horizon overall: mae: 3.0037, mape: 7.9702, rmse: 6.2139 
Horizon 15mins: mae: 2.6503, mape: 6.6616, rmse: 5.1366 
Horizon 30mins: mae: 3.0314, mape: 8.0529, rmse: 6.2123 
Horizon 60mins: mae: 3.5323, mape: 9.8668, rmse: 7.5259 

 
Epoch [40/200] (15000) train_loss: 9.0499, train_mae_loss: 2.1338, train_contra_loss: 0.1050, train_detect_loss: 6.9056, val_loss: 2.8167, lr: 0.010000, 329.25s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    806      84    1953   36913     566      31     341    1040    2202
       52     282     311     484  108781 1783213      89 3023901     347
     1108     114]
 [ 261887    1492  436655  611295   46675   40126   31450   55279   50577
   357348   11037   11382   70316  944415  906948    8540  973717   16636
   111672   15171]
 [    464      78    1321    9256     201      14     171     247     880
        7      55      84     275   78276 1840999      43 3029593      84
      554      16]
 [ 287168    1291  395512  632982   42331   25974   30811   31719   43114
   425568    4026    7795   61415  931097  918717    7396  995391   14600
    96345    9366]] 
Horizon overall: mae: 3.0661, mape: 8.7055, rmse: 6.2823 
Horizon 15mins: mae: 2.6750, mape: 7.0388, rmse: 5.1501 
Horizon 30mins: mae: 3.0939, mape: 8.7460, rmse: 6.2894 
Horizon 60mins: mae: 3.6364, mape: 11.0943, rmse: 7.6175 

 
Epoch [41/200] (15375) train_loss: 9.0916, train_mae_loss: 2.1887, train_contra_loss: 0.1187, train_detect_loss: 6.8910, val_loss: 2.8115, lr: 0.010000, 331.68s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    658      50     619   54989      61      91     217     326    3200
       32     374     348     432   75061 1817400      73 3007907     190
      506      84]
 [ 239884    3294  379974  678547    7319   66332   52774   46702  151614
   215719   25824   15064   42520  729440 1122573   17765 1096979   17480
    42018   10796]
 [    370      60     368   23129       3       7      47      84    1021
        4      58     152     107   51387 1903479      39 2982013      59
      208      23]
 [ 252754    3014  389415  697081    6524   43130   43397   26842  123376
   263166   11517   10301   38675  697364 1158059   15425 1130269   16235
    30213    5861]] 
Horizon overall: mae: 3.0730, mape: 8.6776, rmse: 6.4046 
Horizon 15mins: mae: 2.6802, mape: 7.0327, rmse: 5.2062 
Horizon 30mins: mae: 3.1017, mape: 8.7493, rmse: 6.4089 
Horizon 60mins: mae: 3.6409, mape: 10.9853, rmse: 7.7984 

 
Epoch [42/200] (15750) train_loss: 8.9752, train_mae_loss: 2.2057, train_contra_loss: 0.1347, train_detect_loss: 6.7561, val_loss: 2.7916, lr: 0.010000, 332.16s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    646     253      23   68022     100      71     162     471    3958
       20     387     280     301   54385 1867866      61 2964344     153
      624     491]
 [ 168069   20516   40490  828299    5937   32691  115258   35594  139636
   133216   19046   23330   50454  636422 1236984   24284 1257911   19755
    94310   80416]
 [    390     228      14   36484      39       4      31     218    1719
       23      78      81      63   39435 1963606      13 2919596      66
      293     237]
 [ 179563   18941   44879  891591    4466   21975  104689   21261  107837
   155362   11948   15685   47383  608977 1256065   19132 1295545   20761
    78180   58378]] 
Horizon overall: mae: 3.0724, mape: 8.4710, rmse: 6.4205 
Horizon 15mins: mae: 2.6777, mape: 6.7521, rmse: 5.2127 
Horizon 30mins: mae: 3.0940, mape: 8.4456, rmse: 6.4009 
Horizon 60mins: mae: 3.6560, mape: 11.0051, rmse: 7.8662 

 
Epoch [43/200] (16125) train_loss: 9.0717, train_mae_loss: 2.2339, train_contra_loss: 0.1414, train_detect_loss: 6.8236, val_loss: 2.8219, lr: 0.010000, 331.55s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    782     165       6   26114     423     126      86     490    1421
       60    1192    1444     703    7147 1875560      60 3046057     370
      331      81]
 [ 272624   20479   39608  292152   23546   29313   76109   20447   44429
   130757   60950  210934   93103  321143 1631587   32746 1515494   37234
    73019   36944]
 [    271      98       4    8490     205       3      33     202     516
       13     385     412     212    4779 1935883       8 3010741     231
      129       3]
 [ 297946   17526   51353  303037   22675   19937   68434   12094   29159
   163247   49601  163529   88017  288630 1665842   24487 1571352   35835
    63035   26882]] 
Horizon overall: mae: 3.0738, mape: 8.4257, rmse: 6.3445 
Horizon 15mins: mae: 2.6975, mape: 6.9008, rmse: 5.2267 
Horizon 30mins: mae: 3.1048, mape: 8.5368, rmse: 6.3616 
Horizon 60mins: mae: 3.6208, mape: 10.5331, rmse: 7.6535 

 
Epoch [44/200] (16500) train_loss: 9.0421, train_mae_loss: 2.2796, train_contra_loss: 0.1730, train_detect_loss: 6.7451, val_loss: 2.7450, lr: 0.010000, 330.30s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    718     174     190   33451     600     203     254     428    2844
      153    1662     799     568    1865 1958258      78 2958582    1053
      599     139]
 [ 189330   18165   59817  245266   34678   19491   30855   14889   67289
   156917   34677   25520   62731  135842 1838439   36002 1772472   68789
   135204   16245]
 [    659      97     197   10097     410      80      49     155    1648
       63     785     164     231     850 1947126      11 2999033     800
      117      46]
 [ 244540   14581   56000  213544   36686   13610   27001   10335   49678
   192806   24166   15944   59062  117628 1907092   28983 1758822   66618
   113746   11776]] 
Horizon overall: mae: 3.0098, mape: 8.2333, rmse: 6.2135 
Horizon 15mins: mae: 2.6614, mape: 6.7365, rmse: 5.1367 
Horizon 30mins: mae: 3.0410, mape: 8.2469, rmse: 6.2210 
Horizon 60mins: mae: 3.5144, mape: 10.4092, rmse: 7.4869 

 
Epoch [45/200] (16875) train_loss: 8.9596, train_mae_loss: 2.3182, train_contra_loss: 0.2094, train_detect_loss: 6.6204, val_loss: 2.8679, lr: 0.010000, 333.38s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    503     100      34   96124     165     182     273     309   15860
      128     810     343     957     943 2812110      26 2033242     232
      219      58]
 [  36234    4931    9056  422533    6055    8810   32093    9231  146091
    51269    7891    4335   43366   11154 1627794   30696 2461221   29655
    12719    7484]
 [    324      33      22   41631     163       9     120     183    8044
       88     304     130     565     299 2899026       4 2011460     125
       66      22]
 [  41191    3005    6656  394900    6184    3915   30466    6108   91382
    55516    4424    2234   36195    8145 1680802   26932 2525229   25215
     8516    5603]] 
Horizon overall: mae: 3.1318, mape: 8.9995, rmse: 6.4637 
Horizon 15mins: mae: 2.7263, mape: 7.3110, rmse: 5.2328 
Horizon 30mins: mae: 3.1622, mape: 9.1102, rmse: 6.4770 
Horizon 60mins: mae: 3.7118, mape: 11.3278, rmse: 7.8652 

 
Epoch [46/200] (17250) train_loss: 9.2271, train_mae_loss: 2.3776, train_contra_loss: 0.1089, train_detect_loss: 6.8386, val_loss: 2.7780, lr: 0.010000, 341.46s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[   2948     603     111    5188     763    3657     445    1113   17753
     1739    2194    2693    1928   26129 4281970     272  612119     181
      465     347]
 [   5656   69498    2272  234215    7039   35084   39223    9856  119125
    11251    4311    6807   17708  245834  567675   54477 3517745    3813
     5323    5706]
 [   1399     307       7    3539     335     701     202     296    8997
      606     682     798     219   17896 4433391      52  493014      12
      104      61]
 [   3375   49578    1680  262103    5743   30113   35134    6941   98273
     6259    2087    1423   10912  227542  474918   50461 3683872    4372
     3387    4445]] 
Horizon overall: mae: 3.0523, mape: 8.7318, rmse: 6.3131 
Horizon 15mins: mae: 2.6966, mape: 7.1919, rmse: 5.2120 
Horizon 30mins: mae: 3.0879, mape: 8.8647, rmse: 6.3307 
Horizon 60mins: mae: 3.5695, mape: 10.8706, rmse: 7.6110 

 
Epoch [47/200] (17625) train_loss: 9.4924, train_mae_loss: 2.3714, train_contra_loss: 0.0480, train_detect_loss: 7.1161, val_loss: 2.7919, lr: 0.010000, 345.13s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     67     245      45     352     695     353     572     405   18011
      269     168     282     743    5400 4688813     146  245865      51
       37      99]
 [    658   49338   10314    4447    9306    9991   55260    4696  196741
     2602     318     857    5734   88251  249523   49083 4217104    1662
      314    6419]
 [     19     100       5     185     184      50     545     158   11542
      125      74     120     147    2785 4773194      35  173308      21
        1      20]
 [    451   31231    8421    4376    6854    8623   53073    4006  189467
     2193      97     687    4683   81891  178139   46188 4333090    1780
      223    7145]] 
Horizon overall: mae: 3.0318, mape: 8.2552, rmse: 6.3238 
Horizon 15mins: mae: 2.6705, mape: 6.8442, rmse: 5.2014 
Horizon 30mins: mae: 3.0637, mape: 8.3096, rmse: 6.3423 
Horizon 60mins: mae: 3.5519, mape: 10.2989, rmse: 7.6316 

 
Epoch [48/200] (18000) train_loss: 9.6409, train_mae_loss: 2.4290, train_contra_loss: 0.0123, train_detect_loss: 7.2107, val_loss: 2.7597, lr: 0.010000, 341.93s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    194      89      98     567     705     389      85     808    3615
      147     271     214     463    3251 4896937      86   54305     258
       57      79]
 [   2001   52017   36757    4415   18174   14009   88618   23049  113477
     7206     438    1031    3224   59907   56954   96133 4359591   18812
      266    6539]
 [    121       3      23     201     155      94      11     153    3333
       28      32      98      17     800 4924793      24   32574     141
        7      10]
 [   2256   26312   30662    3401   14238    9408   90100   18054   95082
     5674     107     966    1156   42999   35143   91993 4465688   21784
       59    7536]] 
Horizon overall: mae: 3.0200, mape: 8.0553, rmse: 6.2552 
Horizon 15mins: mae: 2.6619, mape: 6.7961, rmse: 5.1492 
Horizon 30mins: mae: 3.0444, mape: 8.1389, rmse: 6.2516 
Horizon 60mins: mae: 3.5417, mape: 9.8457, rmse: 7.5672 

 
Epoch [49/200] (18375) train_loss: 9.6487, train_mae_loss: 2.4435, train_contra_loss: 0.0154, train_detect_loss: 7.2037, val_loss: 2.7770, lr: 0.010000, 342.46s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    240      51      51    1314    1140     283     104    3294    6621
      999     179     195     437    1502 4877407      83   68308      90
       42     278]
 [   2001    5898   27930    7892   15799   20992   64666   37728   85585
    12570     326    1610    3532   22269   73516   53331 4506284    7146
      208   13335]
 [    266       6      39     530     432      74      22    1148    5753
      200      62       7       8     458 4910221      17   43288      26
        3      58]
 [   2446    1566   19569    5260   12122   13818   59971   29284   56677
     9081      91    1371    1751   17899   48626   37766 4626699    6892
       47   11682]] 
Horizon overall: mae: 3.0411, mape: 8.5839, rmse: 6.1699 
Horizon 15mins: mae: 2.6984, mape: 7.0898, rmse: 5.1499 
Horizon 30mins: mae: 3.0792, mape: 8.6516, rmse: 6.2085 
Horizon 60mins: mae: 3.5366, mape: 10.7584, rmse: 7.3739 

 
Epoch [50/200] (18750) train_loss: 9.7403, train_mae_loss: 2.5099, train_contra_loss: 0.0194, train_detect_loss: 7.2285, val_loss: 2.7501, lr: 0.001000, 344.12s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    373     250     193    2237     660     920     167    7817   14255
      849     981     337     931    5184 4858030     121   68713      97
      361     142]
 [   7147   37746   42895   11927    9003   69846   71282   40419   94223
     9619    6414    1575    8889   47551   80693   74003 4300868   20108
     6053   22357]
 [    465      70      76    1165     158     196      34    3114    8345
      248     392     103      66    1489 4912696      13   33825       3
      107      53]
 [  10967   21251   38358   10221    4627   59176   77439   33167   73662
     6766    3471    1015    3801   34632   42778   67859 4424450   18578
     5107   25293]] 
Horizon overall: mae: 3.0012, mape: 8.1681, rmse: 6.1507 
Horizon 15mins: mae: 2.6674, mape: 6.8635, rmse: 5.1290 
Horizon 30mins: mae: 3.0402, mape: 8.2953, rmse: 6.1959 
Horizon 60mins: mae: 3.4727, mape: 9.9590, rmse: 7.3291 

 
Epoch [51/200] (19125) train_loss: 9.7439, train_mae_loss: 2.3738, train_contra_loss: 0.0132, train_detect_loss: 7.3687, val_loss: 2.6821, lr: 0.001000, 346.90s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    146      68      22     679     468     144      36    8605   21227
       78    1041     144     417    1773 4899133      10   28243      11
      328      45]
 [  11234   32003   57011   13755   12334   84069  146141   45870   95644
     9353   11985     795   10879   43686   48861   96440 4121099   35041
    21894   64524]
 [     13      24       0     196     126       0       0    3765    6527
       20     280      14      90     202 4939394       0   11940       0
       23       4]
 [  17115   15961   48578   10087    4558   62725  177823   20223   30624
     2483    6721     652    3926   26048   21138   96369 4290384   39659
    15673   71871]] 
Horizon overall: mae: 2.9310, mape: 7.9853, rmse: 6.0392 
Horizon 15mins: mae: 2.6084, mape: 6.6624, rmse: 5.0347 
Horizon 30mins: mae: 2.9717, mape: 8.0855, rmse: 6.0779 
Horizon 60mins: mae: 3.3830, mape: 9.8164, rmse: 7.1984 

 
Epoch [52/200] (19500) train_loss: 9.9136, train_mae_loss: 2.3635, train_contra_loss: 0.0104, train_detect_loss: 7.5490, val_loss: 2.6805, lr: 0.001000, 349.21s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    187      55      47    1710     523     131      32    5115   13014
      181     814     188     518    2073 4913295      14   24227       9
      426      59]
 [  15992   34115   55895   25635   11315   92183  143381   31939   60845
    10943   11653    1044   15255   48129   38472  120718 4113756   42352
    20627   68369]
 [     25      24       0     578     193       0       0    3456    7420
       42      93       7     166     367 4939843       0   10344       0
       60       0]
 [  24305   14578   45350   18412    4951   75965  161402   15746   31783
     3805    6529     683    5372   28974   20990  116043 4253564   46697
    14930   72539]] 
Horizon overall: mae: 2.9323, mape: 8.0188, rmse: 6.0586 
Horizon 15mins: mae: 2.6133, mape: 6.7240, rmse: 5.0532 
Horizon 30mins: mae: 2.9736, mape: 8.1331, rmse: 6.1012 
Horizon 60mins: mae: 3.3820, mape: 9.8079, rmse: 7.2155 

 
Epoch [53/200] (19875) train_loss: 10.0341, train_mae_loss: 2.3657, train_contra_loss: 0.0101, train_detect_loss: 7.6674, val_loss: 2.6915, lr: 0.001000, 349.31s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    149      49      46    1591     501     177      37    5067   13058
      290     842     144     586    2125 4914241       8   23121      11
      517      58]
 [  17466   34620   62251   31343   12186   90892  132704   39241   66973
    13871   10583    1053   20646   53909   37993  121521 4098316   40995
    18002   58053]
 [      5       7       0     526     126       0       0    3382    7409
       40     108      24     107     404 4941906       0    8443       0
      131       0]
 [  26235   15631   52261   20821    5663   75137  154035   21040   37079
     5311    6183     552    7719   34207   19394  116582 4247349   44545
    12881   59993]] 
Horizon overall: mae: 2.9406, mape: 7.8547, rmse: 6.0769 
Horizon 15mins: mae: 2.6155, mape: 6.6353, rmse: 5.0630 
Horizon 30mins: mae: 2.9809, mape: 7.9720, rmse: 6.1188 
Horizon 60mins: mae: 3.3954, mape: 9.5233, rmse: 7.2402 

 
Epoch [54/200] (20250) train_loss: 10.1468, train_mae_loss: 2.3652, train_contra_loss: 0.0113, train_detect_loss: 7.7805, val_loss: 2.6960, lr: 0.001000, 267.28s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     95      45      56    1703     520     189      36    5610   13715
      316     990     196     816    2489 4906963       8   27989       2
      819      61]
 [  14679   32264   59771   29776    9521   90386  131688   49630   76487
    13915   12360    1046   28457   57783   44068  123389 4079399   34010
    21383   52606]
 [      0       0       0     545      87       0       0    3343    6832
       75     127      97     111     706 4939495       0   10849       0
      351       0]
 [  22150   13761   49322   19204    3759   75659  148508   30288   39252
     5677    7500     409   10452   36250   21390  117537 4254404   34915
    15933   56248]] 
Horizon overall: mae: 2.9444, mape: 7.9673, rmse: 6.1121 
Horizon 15mins: mae: 2.6175, mape: 6.6697, rmse: 5.0885 
Horizon 30mins: mae: 2.9852, mape: 8.0797, rmse: 6.1545 
Horizon 60mins: mae: 3.4038, mape: 9.7488, rmse: 7.2888 

 
Epoch [55/200] (20625) train_loss: 10.2709, train_mae_loss: 2.3768, train_contra_loss: 0.0113, train_detect_loss: 7.8930, val_loss: 2.7088, lr: 0.001000, 260.12s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     77      46      64    1419     540     258      36    5443   14310
      489    1175     228     986    2926 4906956       9   26664       1
      922      69]
 [  14167   34350   60029   34228   12045   92206  143866   59532   97757
    21571   15662     909   38753   74066   44316  145654 3950289   38737
    27306   57175]
 [      0       0       4     403      66      18       0    2825    6349
       47     259     130     148     839 4940537       0   10596       0
      397       0]
 [  19942   16330   50907   21254    5230   76203  162607   33464   50296
     8947   10271     192   14891   51210   20166  136637 4162266   40363
    19595   61847]] 
Horizon overall: mae: 2.9549, mape: 7.9350, rmse: 6.1097 
Horizon 15mins: mae: 2.6262, mape: 6.6892, rmse: 5.0836 
Horizon 30mins: mae: 2.9965, mape: 8.0616, rmse: 6.1527 
Horizon 60mins: mae: 3.4156, mape: 9.6266, rmse: 7.2831 

 
Epoch [56/200] (21000) train_loss: 10.3704, train_mae_loss: 2.3693, train_contra_loss: 0.0126, train_detect_loss: 7.9998, val_loss: 2.7037, lr: 0.001000, 258.78s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     72      35      67    1367     556     250      31    5914   11771
      628    1424     197    1087    3244 4898654      17   36228       1
      951     124]
 [  12175   34960   57175   32370   10269   92341  143206   59247   80730
    25124   20240     908   46717   88725   52009  157404 3928424   34367
    25943   60284]
 [      0       0      24     224      17      12       0    3171    4775
       80     314     126     104     973 4935864       0   16350       0
      584       0]
 [  17511   16789   48478   21298    4951   74900  166793   38089   52232
    13168   13214     184   19801   63830   24671  144773 4121839   36059
    18005   66033]] 
Horizon overall: mae: 2.9649, mape: 8.2067, rmse: 6.1643 
Horizon 15mins: mae: 2.6339, mape: 6.8085, rmse: 5.1150 
Horizon 30mins: mae: 3.0084, mape: 8.3162, rmse: 6.2089 
Horizon 60mins: mae: 3.4275, mape: 10.1351, rmse: 7.3593 

 
Epoch [57/200] (21375) train_loss: 10.4689, train_mae_loss: 2.3737, train_contra_loss: 0.0146, train_detect_loss: 8.0938, val_loss: 2.7086, lr: 0.001000, 258.56s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     77      24      81    1354     699     294      46    5471   12269
     1015    1569     264    1472    3779 4886144      19   46844       5
     1083     109]
 [  12459   30066   49226   27296   10609   80754  146560   69332   89543
    31821   23836    1009   53674   94167   62187  151518 3897659   38699
    29595   62608]
 [      0       0      15     200       5      12       0    2865    4707
       86     485     169     198    1175 4931010       0   21065       0
      626       0]
 [  17691   13794   42476   16723    4251   65072  172817   55742   61521
    18534   15822     289   23615   68981   28851  143437 4079494   41618
    21529   70361]] 
Horizon overall: mae: 2.9637, mape: 8.0313, rmse: 6.1430 
Horizon 15mins: mae: 2.6357, mape: 6.7641, rmse: 5.1145 
Horizon 30mins: mae: 3.0060, mape: 8.1661, rmse: 6.1940 
Horizon 60mins: mae: 3.4245, mape: 9.7534, rmse: 7.3179 

 
Epoch [58/200] (21750) train_loss: 10.5270, train_mae_loss: 2.3648, train_contra_loss: 0.0155, train_detect_loss: 8.1607, val_loss: 2.7151, lr: 0.001000, 256.51s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     76      21      76    1424     730     397      59    4461   14068
     1246    1374     259    1703    3832 4881105      16   50574       2
     1085     110]
 [  10432   29439   49761   22340   10034   75878  144386   69274   98525
    31323   21526    1082   66958   97836   66441  132238 3917471   33001
    29281   55392]
 [      0       0      13     228       1      23       0    1920    3935
      135     388     164     227    1059 4931699       0   22213       0
      613       0]
 [  15159   14006   45923   13221    3525   59695  177415   61168   63376
    17869   15258     270   34804   71471   28429  123525 4097711   35136
    21902   62755]] 
Horizon overall: mae: 2.9741, mape: 8.0990, rmse: 6.1650 
Horizon 15mins: mae: 2.6402, mape: 6.7512, rmse: 5.1234 
Horizon 30mins: mae: 3.0159, mape: 8.2115, rmse: 6.2069 
Horizon 60mins: mae: 3.4443, mape: 9.9506, rmse: 7.3645 

 
Epoch [59/200] (22125) train_loss: 10.5695, train_mae_loss: 2.3708, train_contra_loss: 0.0183, train_detect_loss: 8.1969, val_loss: 2.7262, lr: 0.001000, 254.51s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     95      18      76    1399     931     519      80    3942   20805
     1964    1576     377    2006    5148 4866868      17   55382       4
     1239     172]
 [  10499   32470   47317   18534   13520   78565  140621   63521  124656
    35418   27477    1270   80262  102647   76287  118029 3864276   33025
    34765   59459]
 [      0       0      13     159      19      62       0    1571    5366
      314     499     264     119    1375 4928655       0   23518       0
      669      15]
 [  14404   15376   42966    9647    6022   61157  166392   60757   78929
    20963   19653     366   42336   77619   31001  110966 4074957   34488
    25002   69617]] 
Horizon overall: mae: 2.9817, mape: 8.1395, rmse: 6.1846 
Horizon 15mins: mae: 2.6441, mape: 6.8068, rmse: 5.1373 
Horizon 30mins: mae: 3.0243, mape: 8.2655, rmse: 6.2309 
Horizon 60mins: mae: 3.4535, mape: 9.9566, rmse: 7.3789 

 
Epoch [60/200] (22500) train_loss: 10.6091, train_mae_loss: 2.3600, train_contra_loss: 0.0182, train_detect_loss: 8.2473, val_loss: 2.7245, lr: 0.001000, 253.65s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    101      19      85    1116    1358     605     109    2401   21465
     2171    1820     397    2164    5398 4867318      22   54418       2
     1468     181]
 [   8558   32954   45793   13104   19148   85645  142614   43780  157406
    39927   28955    1524   91019  109203   75491  114429 3799522   30230
    42630   80686]
 [      0       0      13      76     138      71       0     859    4860
      363     997     231      96    1473 4928462       0   24252       0
      710      17]
 [  11104   17361   42039    5737   12721   66876  167975   42515   94729
    28585   21910     438   53016   83824   30358  106888 4020082   29930
    32139   94391]] 
Horizon overall: mae: 2.9814, mape: 8.1885, rmse: 6.1909 
Horizon 15mins: mae: 2.6435, mape: 6.8149, rmse: 5.1326 
Horizon 30mins: mae: 3.0256, mape: 8.3167, rmse: 6.2412 
Horizon 60mins: mae: 3.4503, mape: 10.0610, rmse: 7.3865 

 
Epoch [61/200] (22875) train_loss: 10.6729, train_mae_loss: 2.3561, train_contra_loss: 0.0200, train_detect_loss: 8.3148, val_loss: 2.7316, lr: 0.001000, 251.19s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     85       9      89    1093    1332     741     114    1092   23714
     2334    1882     356    1958    5863 4858097      13   62007       4
     1586     249]
 [   7159   30839   34727   10862   20570   91764  138687   29511  177739
    43326   28857    1619   89891  108284   84540  103407 3786907   29178
    52063   92688]
 [      0       0      17      49     248     223       0     214    4159
      344     900     228      70    1530 4927853       0   26038       0
      706      39]
 [   9097   17292   30969    3205   14450   73199  167341   28700  113735
    32469   21489     377   54475   82377   31431   97127 4007273   28781
    41188  107643]] 
Horizon overall: mae: 2.9894, mape: 8.1195, rmse: 6.1996 
Horizon 15mins: mae: 2.6470, mape: 6.8123, rmse: 5.1417 
Horizon 30mins: mae: 3.0321, mape: 8.2587, rmse: 6.2457 
Horizon 60mins: mae: 3.4659, mape: 9.8873, rmse: 7.3998 

 
Epoch [62/200] (23250) train_loss: 10.7172, train_mae_loss: 2.3532, train_contra_loss: 0.0214, train_detect_loss: 8.3618, val_loss: 2.7347, lr: 0.001000, 250.74s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[     90       7      87    1266    1485     769     126     687   21532
     2842    2307     470    2445    6755 4848219      12   71464       1
     1889     165]
 [   5928   26741   30182    6471   22869   95238  127817   19409  157277
    37672   30377    2109   86498   99730   90787   86688 3881390   22727
    44909   87799]
 [      0       0       9       8     272     287       0      40    2997
      463    1446     282      34    1748 4925617       0   28617       0
      775      23]
 [   7680   14447   26590    1774   16913   76596  146554   19038  109860
    29736   22830     382   51239   73086   32502   77880 4097023   23181
    35570   99737]] 
Horizon overall: mae: 2.9936, mape: 8.2472, rmse: 6.2325 
Horizon 15mins: mae: 2.6497, mape: 6.8594, rmse: 5.1674 
Horizon 30mins: mae: 3.0365, mape: 8.3688, rmse: 6.2814 
Horizon 60mins: mae: 3.4719, mape: 10.1469, rmse: 7.4402 

 
Epoch [63/200] (23625) train_loss: 10.7380, train_mae_loss: 2.3470, train_contra_loss: 0.0213, train_detect_loss: 8.3888, val_loss: 2.7460, lr: 0.001000, 250.47s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    110      14      85    1243    1346     678     134     658   27329
     3092    2118     553    2592    7397 4850661      24   62635       5
     1796     148]
 [   6379   25513   30350    5808   21108   90593  133089   15499  189150
    42748   34483    2667  102789  104563   88605   85176 3816792   25646
    51169   90491]
 [      1       0      17      13     291     158       0      16    2273
      524    1093     303      68    2018 4929966       0   25035       0
      830      12]
 [   7711   14596   25600    2021   14703   69840  149754   14395  129998
    33209   25379     483   64966   77266   28642   74433 4060230   26487
    40538  102367]] 
Horizon overall: mae: 3.0196, mape: 8.2913, rmse: 6.2972 
Horizon 15mins: mae: 2.6662, mape: 6.8869, rmse: 5.2043 
Horizon 30mins: mae: 3.0644, mape: 8.4119, rmse: 6.3481 
Horizon 60mins: mae: 3.5082, mape: 10.2125, rmse: 7.5284 

 
Epoch [64/200] (24000) train_loss: 10.7847, train_mae_loss: 2.3427, train_contra_loss: 0.0228, train_detect_loss: 8.4397, val_loss: 2.7332, lr: 0.001000, 249.31s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    110      11      62    1480    2042     740     168     586   30371
     3334    2405     558    3574    8846 4841837      21   64613       1
     1736     123]
 [   5398   26119   29188    6155   22462   99298  146264   13154  208787
    40782   30800    3585  121126  122060   94553   85930 3746592   22731
    55330   82304]
 [      1       0       6      57     593      68       0      22    3230
      519    1641     255      81    2543 4929058       0   23816       0
      719       9]
 [   6090   14469   24497    1888   14965   77524  164858   11373  138673
    31428   23212     694   82477   91153   29015   75716 4009848   24924
    45435   94379]] 
Horizon overall: mae: 3.0079, mape: 8.1797, rmse: 6.2399 
Horizon 15mins: mae: 2.6637, mape: 6.8422, rmse: 5.1856 
Horizon 30mins: mae: 3.0555, mape: 8.3052, rmse: 6.3011 
Horizon 60mins: mae: 3.4819, mape: 10.0093, rmse: 7.4257 

 
Epoch [65/200] (24375) train_loss: 10.7784, train_mae_loss: 2.3331, train_contra_loss: 0.0284, train_detect_loss: 8.4425, val_loss: 2.7433, lr: 0.001000, 250.11s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    115       5      52    1435    2042     652     192     550   31573
     3726    1806     514    3476    9877 4808443      23   96008       1
     1977     151]
 [   4304   23407   28526    5509   22647   82274  126703   11090  200020
    32997   23872    3542  106376  117579  122796   78692 3824721   16901
    54645   76017]
 [      0       0       2      69     676      72       1      17    2411
      588    1262     118      43    2921 4912528       0   41089       0
      814       7]
 [   4695   12814   25438    1534   13633   64447  133750    9011  138742
    24478   18826     749   70058   87324   45149   68411 4093045   18296
    46962   85256]] 
Horizon overall: mae: 3.0061, mape: 8.2118, rmse: 6.2388 
Horizon 15mins: mae: 2.6642, mape: 6.8797, rmse: 5.1889 
Horizon 30mins: mae: 3.0497, mape: 8.3443, rmse: 6.2881 
Horizon 60mins: mae: 3.4836, mape: 10.0310, rmse: 7.4365 

 
Epoch [66/200] (24750) train_loss: 10.8078, train_mae_loss: 2.3280, train_contra_loss: 0.0355, train_detect_loss: 8.4762, val_loss: 2.7418, lr: 0.001000, 247.70s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    151       7      48    1407    2235     913     211     564   34912
     3160    1668     526    3620   11789 4767390      18  131592       3
     2289     115]
 [   3414   19721   25043    4396   18061   78768  104619    9164  210184
    22241   20451    3796   95251  101006  158291   56881 3902719   11978
    55271   61363]
 [      0       0       1      40     858     143       1      56    4470
      600    1224     138     104    3907 4890713       1   59501       0
      843      18]
 [   3685    9280   21782    1046    9581   61090  114496    6666  161306
    14865   17192     697   64050   74046   64948   48057 4156419   12535
    49651   71226]] 
Horizon overall: mae: 3.0193, mape: 8.3066, rmse: 6.2928 
Horizon 15mins: mae: 2.6696, mape: 6.9059, rmse: 5.2115 
Horizon 30mins: mae: 3.0634, mape: 8.4262, rmse: 6.3438 
Horizon 60mins: mae: 3.5042, mape: 10.2290, rmse: 7.5171 

 
Epoch [67/200] (25125) train_loss: 10.8230, train_mae_loss: 2.3259, train_contra_loss: 0.0432, train_detect_loss: 8.4928, val_loss: 2.7470, lr: 0.001000, 250.49s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    129       5      59    1365    1974     773     261     555   35731
     2336    1807     521    3017   11866 4723618       7  176034       8
     2464      88]
 [   2777   16857   23279    3891   16668   74442  104649    9262  201922
    16379   19957    3884   82842   93201  198977   54103 3920166   10242
    51137   57983]
 [      0       0       1      22     706     102       8      11    4261
      543    1377     123      94    3894 4860380       0   90287       0
      800       9]
 [   2839    7472   20234     717    8342   55925  119556    6295  157955
     8901   16724     631   59384   67637   94629   44692 4168994   10536
    45972   65183]] 
Horizon overall: mae: 3.0118, mape: 8.2557, rmse: 6.2701 
Horizon 15mins: mae: 2.6663, mape: 6.8999, rmse: 5.2058 
Horizon 30mins: mae: 3.0566, mape: 8.3781, rmse: 6.3238 
Horizon 60mins: mae: 3.4902, mape: 10.1169, rmse: 7.4750 

 
Epoch [68/200] (25500) train_loss: 10.8102, train_mae_loss: 2.3204, train_contra_loss: 0.0533, train_detect_loss: 8.4845, val_loss: 2.7431, lr: 0.001000, 250.70s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    125       4      57    1441    2300    1056     376     786   37952
     2117    2098     702    3319   13174 4664471       7  229671       8
     2870      84]
 [   2561   12894   19403    3518   15613   56869   87229    9071  184824
    13631   20130    4393   65988   91096  251487   40709 3987647    7143
    44530   43882]
 [      1       0       3      63    1059     232      32      16    5330
      564    1528     135     103    5132 4826081       0  121393       0
      927      19]
 [   2510    4893   16624     670    7874   39758   93474    5710  135486
     6421   16656     921   47026   73574  126792   33731 4255555    7010
    39361   48572]] 
Horizon overall: mae: 3.0173, mape: 8.1726, rmse: 6.2784 
Horizon 15mins: mae: 2.6666, mape: 6.8545, rmse: 5.2114 
Horizon 30mins: mae: 3.0620, mape: 8.3100, rmse: 6.3341 
Horizon 60mins: mae: 3.5006, mape: 9.9566, rmse: 7.4810 

 
Epoch [69/200] (25875) train_loss: 10.8013, train_mae_loss: 2.3129, train_contra_loss: 0.0590, train_detect_loss: 8.4825, val_loss: 2.7510, lr: 0.001000, 250.28s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    144       4      53    1767    2468    1110     486     741   38789
     1967    2060     710    3334   12276 4629409      11  264138       5
     3069      77]
 [   2257   10215   15604    4527   16723   52633   80160    8393  178541
    12733   17613    4662   55717   87678  281535   29641 4021047    5307
    40949   36683]
 [      0       0       0      68    1125     255      17      15    3928
      497    1573     100      83    4710 4805986       0  143359       0
      884      18]
 [   2238    3638   13454     541    8465   37003   85705    5319  138017
     5548   14661     951   39010   75733  146419   25739 4281377    4908
    34751   39141]] 
Horizon overall: mae: 3.0325, mape: 8.1919, rmse: 6.3234 
Horizon 15mins: mae: 2.6730, mape: 6.8470, rmse: 5.2220 
Horizon 30mins: mae: 3.0786, mape: 8.3222, rmse: 6.3772 
Horizon 60mins: mae: 3.5248, mape: 10.0136, rmse: 7.5541 

 
Epoch [70/200] (26250) train_loss: 10.8019, train_mae_loss: 2.3070, train_contra_loss: 0.0694, train_detect_loss: 8.4880, val_loss: 2.7578, lr: 0.001000, 249.09s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    186       3      48    2101    2549    1609     599    1091   42317
     1836    2242     734    3342   12601 4564653      18  322880      10
     3670     129]
 [   2588   10121   17475    4687   15824   55945   69257   10046  158053
    12811   19035    4729   53641   83399  336882   29090 3996589    4373
    40802   37271]
 [      0       0       1      83    1235     558      48      52    5591
      510    1852      88      71    4870 4752246       0  194198       1
     1194      20]
 [   2391    3507   14788     544    7375   38568   72188    6370  120895
     4597   14651    1035   38448   71739  197234   23891 4267068    3829
    33360   40140]] 
Horizon overall: mae: 3.0347, mape: 8.3334, rmse: 6.3198 
Horizon 15mins: mae: 2.6767, mape: 6.9426, rmse: 5.2282 
Horizon 30mins: mae: 3.0813, mape: 8.4756, rmse: 6.3784 
Horizon 60mins: mae: 3.5260, mape: 10.2154, rmse: 7.5414 

 
Epoch [71/200] (26625) train_loss: 10.8098, train_mae_loss: 2.3000, train_contra_loss: 0.0687, train_detect_loss: 8.5030, val_loss: 2.7648, lr: 0.001000, 248.56s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    192      11      54    2371    2483    2028     729    1006   48602
     1568    2466     758    3234   13756 4570413      13  309371      18
     3423     122]
 [   2285   14194   22263    4508   14771   68190   80456    8694  170144
    10891   24483    5750   55700   93986  330311   29954 3940343    5115
    40755   39825]
 [      1       0      12      37    1000     834      76      80    5761
      497    1981     107      54    6277 4755425       0  189179       0
     1269      28]
 [   1772    5345   19409     483    7046   45095   84989    4703  129465
     3517   18305    1634   41609   86858  193479   24027 4215957    4491
    33623   40811]] 
Horizon overall: mae: 3.0315, mape: 8.3491, rmse: 6.3021 
Horizon 15mins: mae: 2.6749, mape: 6.9314, rmse: 5.2173 
Horizon 30mins: mae: 3.0783, mape: 8.4798, rmse: 6.3574 
Horizon 60mins: mae: 3.5198, mape: 10.2786, rmse: 7.5224 

 
Epoch [72/200] (27000) train_loss: 10.8374, train_mae_loss: 2.2969, train_contra_loss: 0.0697, train_detect_loss: 8.5335, val_loss: 2.7607, lr: 0.001000, 249.58s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    220      18      81    2571    2974    2523    1034    1341   47254
     1773    3066     999    4031   13759 4560177      40  316454      24
     4059     220]
 [   2350   18335   25209    4982   15177   77987   81464   10487  162755
    12067   30635    6352   59800   94075  331408   31868 3901474    5399
    48252   42542]
 [      0       0      14      69    1313    1124     155     158    6299
      533    2376     154     106    6409 4743990       5  198238       2
     1583      90]
 [   1830    8135   22031     546    6645   51328   84609    6273  126486
     4242   22560    1975   44027   88157  202391   24514 4182071    4100
    39227   41471]] 
Horizon overall: mae: 3.0387, mape: 8.3472, rmse: 6.3492 
Horizon 15mins: mae: 2.6813, mape: 6.9477, rmse: 5.2516 
Horizon 30mins: mae: 3.0892, mape: 8.4901, rmse: 6.4161 
Horizon 60mins: mae: 3.5260, mape: 10.2491, rmse: 7.5716 

 
Epoch [73/200] (27375) train_loss: 10.8890, train_mae_loss: 2.2901, train_contra_loss: 0.0702, train_detect_loss: 8.5918, val_loss: 2.7634, lr: 0.001000, 249.71s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    215       8      68    2566    2840    2248    1011    1144   43237
     1468    3542    1014    3707   13464 4553414      31  328533      35
     3884     189]
 [   2423   18072   29370    4645   15828   68565   74264    8946  162972
    11339   35449    6887   58039   97818  338656   29066 3901407    5887
    47087   45898]
 [      0       0      23     158    1162     988     162     133    5224
      323    2812     155     136    6559 4736331       8  206947       1
     1426      70]
 [   1792    7957   27194     450    6617   44556   76072    5372  123887
     3676   27526    2101   43252   91956  209491   22554 4179088    4937
    38110   46030]] 
Horizon overall: mae: 3.0431, mape: 8.3325, rmse: 6.3578 
Horizon 15mins: mae: 2.6805, mape: 6.9052, rmse: 5.2500 
Horizon 30mins: mae: 3.0904, mape: 8.4511, rmse: 6.4155 
Horizon 60mins: mae: 3.5400, mape: 10.2839, rmse: 7.5959 

 
Epoch [74/200] (27750) train_loss: 10.9104, train_mae_loss: 2.2876, train_contra_loss: 0.0764, train_detect_loss: 8.6151, val_loss: 2.7680, lr: 0.001000, 248.38s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    231      14      91    2155    2424    2347    1105    1074   43182
     1189    3105    1246    3535   11631 4513576      44  371414      44
     3978     233]
 [   2112   19509   31652    4129   13304   72007   77022    7221  172215
    10181   35637    7774   57538   88985  377902   26548 3859459    5437
    47195   46791]
 [      4       0       5     106     877    1225     171     202    6829
      332    2544     262      61    5434 4690681      12  252158       2
     1592     121]
 [   1633    9865   29058     568    5302   45318   79848    3926  126958
     3184   27963    2912   43596   83647  254291   20587 4137040    4814
    36158   45950]] 
Horizon overall: mae: 3.0354, mape: 8.2549, rmse: 6.3184 
Horizon 15mins: mae: 2.6798, mape: 6.9226, rmse: 5.2306 
Horizon 30mins: mae: 3.0831, mape: 8.4003, rmse: 6.3797 
Horizon 60mins: mae: 3.5230, mape: 10.0551, rmse: 7.5350 

 
Epoch [75/200] (28125) train_loss: 10.9332, train_mae_loss: 2.2855, train_contra_loss: 0.0730, train_detect_loss: 8.6404, val_loss: 2.7686, lr: 0.001000, 249.22s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    191      23     136    2225    2378    2235    1350    1101   47030
      911    3628    1336    4223   10139 4536557      46  344808      84
     4026     191]
 [   2223   20924   35562    4691   14039   74939  101664    7550  182582
     8191   43784    9053   63496   83819  358182   31515 3802031    7507
    46190   64676]
 [      0       0      27      83     875    1022     146     179    7402
      249    2805     213      91    5022 4708694      10  234163      11
     1540      86]
 [   1656   11013   32960     677    5833   47463   94239    4061  129611
     2152   34323    3378   44872   76610  237820   23477 4104562    6297
    36744   64870]] 
Horizon overall: mae: 3.0408, mape: 8.4715, rmse: 6.3544 
Horizon 15mins: mae: 2.6846, mape: 7.0163, rmse: 5.2593 
Horizon 30mins: mae: 3.0868, mape: 8.5895, rmse: 6.4075 
Horizon 60mins: mae: 3.5329, mape: 10.4750, rmse: 7.5904 

 
Epoch [76/200] (28500) train_loss: 10.9495, train_mae_loss: 2.2808, train_contra_loss: 0.0761, train_detect_loss: 8.6611, val_loss: 2.7675, lr: 0.001000, 251.39s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    164      26     149    2158    1673    2106    1381    1250   48661
      663    3129    1478    4035    8102 4515826      44  367608      75
     3886     204]
 [   2209   22224   36227    4895   12007   75954   92355    9032  174168
     6808   39948   10002   58728   78475  379383   24221 3824841    6390
    49252   55499]
 [      0       0      65      58     389     894     219     257    6533
      188    2529     455      47    3740 4689837      12  256029       9
     1231     126]
 [   1897   12056   33350     765    4634   44555   84279    4769  122158
     1616   32232    3525   40267   73542  256666   19074 4127571    5518
    38876   55268]] 
Horizon overall: mae: 3.0451, mape: 8.4223, rmse: 6.3467 
Horizon 15mins: mae: 2.6874, mape: 6.9962, rmse: 5.2588 
Horizon 30mins: mae: 3.0907, mape: 8.5420, rmse: 6.3992 
Horizon 60mins: mae: 3.5434, mape: 10.3928, rmse: 7.5856 

 
Epoch [77/200] (28875) train_loss: 10.9433, train_mae_loss: 2.2772, train_contra_loss: 0.0781, train_detect_loss: 8.6583, val_loss: 2.7729, lr: 0.001000, 252.40s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    178      21     201    2423    2172    2619    1714    1559   58261
      703    3906    2104    4836    8991 4502567      42  365859     121
     4015     326]
 [   2538   27295   39038    5484   14247   86666  101357   10474  199796
     7806   50862   13659   62606   75686  385002   33846 3700985    9139
    54390   81742]
 [      2       0      63     149     842    1436     360     430   10300
      229    3026     715     267    4256 4669782       4  268929      64
     1595     169]
 [   2194   16504   36898    1431    6653   53768   94471    6143  150566
     2499   41762    5222   42841   71781  273213   27273 3993882    7470
    46026   82021]] 
Horizon overall: mae: 3.0505, mape: 8.3367, rmse: 6.3643 
Horizon 15mins: mae: 2.6905, mape: 6.9411, rmse: 5.2666 
Horizon 30mins: mae: 3.0986, mape: 8.4647, rmse: 6.4230 
Horizon 60mins: mae: 3.5477, mape: 10.2598, rmse: 7.6054 

 
Epoch [78/200] (29250) train_loss: 10.9998, train_mae_loss: 2.2709, train_contra_loss: 0.0745, train_detect_loss: 8.7215, val_loss: 2.7761, lr: 0.001000, 251.52s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    150      14     159    2596    2145    2362    1589    1268   53734
      546    3841    1968    4656    8005 4522550      59  352947      94
     3487     448]
 [   2545   25615   38377    5996   15032   88847   95448    9891  188436
     7111   49494   14085   64921   71158  366299   30913 3739610    8697
    50387   89756]
 [      1       0       7     213     880    1147     346     307    9012
      163    2938     511     270    4350 4678328      14  262687       7
     1175     262]
 [   2158   15445   37276    1244    7231   52724   84483    5661  133903
     2086   41166    5381   44531   67274  264121   24357 4033127    7002
    42398   91050]] 
Horizon overall: mae: 3.0464, mape: 8.3031, rmse: 6.3633 
Horizon 15mins: mae: 2.6833, mape: 6.9169, rmse: 5.2583 
Horizon 30mins: mae: 3.0930, mape: 8.4222, rmse: 6.4189 
Horizon 60mins: mae: 3.5460, mape: 10.2149, rmse: 7.6073 

 
Epoch [79/200] (29625) train_loss: 11.0398, train_mae_loss: 2.2648, train_contra_loss: 0.0718, train_detect_loss: 8.7678, val_loss: 2.7855, lr: 0.001000, 251.68s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    118      18     252    3449    2252    2784    2163    1217   47249
      642    4226    2309    6470    8557 4539219     100  337561     111
     3124     797]
 [   2489   43935   38637    7344   17342  111891  113320    8709  183886
     7327   59252   17182   74977   71844  348485   35898 3630746   10689
    51362  127303]
 [      0       0      72     246     917    1572     714     387    8716
      172    3021     626     391    5187 4694647      10  244261      43
     1137     499]
 [   2126   31983   37436    1744    8948   69637  100250    5026  129347
     2199   48427    7049   48836   69284  246497   30048 3940223    8784
    44799  129975]] 
Horizon overall: mae: 3.0682, mape: 8.6019, rmse: 6.4172 
Horizon 15mins: mae: 2.6957, mape: 7.0501, rmse: 5.2802 
Horizon 30mins: mae: 3.1167, mape: 8.7097, rmse: 6.4713 
Horizon 60mins: mae: 3.5771, mape: 10.7403, rmse: 7.6872 

 
Epoch [80/200] (30000) train_loss: 11.0196, train_mae_loss: 2.2616, train_contra_loss: 0.0709, train_detect_loss: 8.7508, val_loss: 2.7761, lr: 0.001000, 250.58s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    199      24     186    3909    3070    2888    1805     965   54985
      712    4321    2601    7409    7705 4545642      88  321661     183
     3555     710]
 [   3328   51675   39008    8104   27420  134064  127115    7655  191303
     7768   68353   20354   86733   73244  338607   44557 3516487   13007
    59373  144463]
 [      2       0      23     252    1365    1425     503     236    8490
      161    2934     714     316    4913 4708209       8  231103     123
     1317     524]
 [   2454   39369   39283    1724   14845   83569  115916    4270  132849
     2390   55053    8730   54421   74386  232721   37281 3856216   11433
    52256  143452]] 
Horizon overall: mae: 3.0689, mape: 8.3303, rmse: 6.4015 
Horizon 15mins: mae: 2.6953, mape: 6.9311, rmse: 5.2792 
Horizon 30mins: mae: 3.1179, mape: 8.4635, rmse: 6.4640 
Horizon 60mins: mae: 3.5734, mape: 10.2112, rmse: 7.6396 

 
Epoch [81/200] (30375) train_loss: 11.0474, train_mae_loss: 2.2583, train_contra_loss: 0.0734, train_detect_loss: 8.7817, val_loss: 2.7962, lr: 0.001000, 199.11s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    165      23     344    4800    3452    3239    1760    1114   53970
      651    4899    3223    7602    7695 4528637     142  336030     238
     3674     960]
 [   3267   56202   44335    9163   32348  143627  120453    7907  179481
     7906   68379   24368   80106   60921  349232   45828 3519624   16877
    60656  131938]
 [      1       7     109     316    1413    1714     423     300   10073
      106    3139    1015     406    5645 4687614       6  248130      88
     1533     580]
 [   2100   43734   43729    2252   17501   89499  102167    4032  124856
     2394   55065   10725   50115   63018  250128   38248 3866320   15128
    53412  128195]] 
Horizon overall: mae: 3.0706, mape: 8.2854, rmse: 6.3989 
Horizon 15mins: mae: 2.6928, mape: 6.9063, rmse: 5.2650 
Horizon 30mins: mae: 3.1183, mape: 8.4149, rmse: 6.4533 
Horizon 60mins: mae: 3.5801, mape: 10.1514, rmse: 7.6520 

 
Epoch [82/200] (30750) train_loss: 11.0858, train_mae_loss: 2.2517, train_contra_loss: 0.0749, train_detect_loss: 8.8266, val_loss: 2.7821, lr: 0.001000, 195.04s 
x_pos_count, x_neg_count, x_his_pos_csount, x_his_neg_count:
[[    157      14     228    4348    3109    3157    1460     934   50690
      573    4183    3580    7272    6564 4515022     161  356515     219
     3777     655]
 [   3571   61923   45694    8708   28568  145247  102210    7792  194596
     8181   66963   29317   82782   70369  365309   51484 3493696   19268
    73131  103809]
 [      0       0      38     224    1207    1491     228     267   11397
      124    3046    1047     188    4645 4665177       7  271527      44
     1590     371]
 [   2354   46385   45500    2633   15035   87728   83926    4324  146039
     3180   52615   13614   53223   76783  272710   43349 3832411   17338
    66524   96947]] 
Horizon overall: mae: 3.0572, mape: 8.3648, rmse: 6.3803 
Horizon 15mins: mae: 2.6911, mape: 6.9595, rmse: 5.2695 
Horizon 30mins: mae: 3.1044, mape: 8.4840, rmse: 6.4365 
Horizon 60mins: mae: 3.5570, mape: 10.2946, rmse: 7.6199 

 
Early stopping at epoch: 82 
===================================Best val_loss model performance=================================== 
======================Better results might be found from model at different epoch====================== 
Horizon overall: mae: 2.9323, mape: 8.0188, rmse: 6.0586 
Horizon 15mins: mae: 2.6133, mape: 6.7240, rmse: 5.0532 
Horizon 30mins: mae: 2.9736, mape: 8.1331, rmse: 6.1012 
Horizon 60mins: mae: 3.3820, mape: 9.8079, rmse: 7.2155 
Inference Time: 27.28s 
METRLA training and testing ended Thu May 22 15:20:13 2025
